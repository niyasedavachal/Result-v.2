import{r as n,i,j as e,h as w,a8 as S,G as C,g as u}from"./index-CR8CapFt.js";import{P as k}from"./printer-29g9zaoY.js";const P=()=>{const[y,d]=n.useState(!1),[x,N]=n.useState([]),[m,f]=n.useState([]),[h,b]=n.useState("ALL"),[v,E]=n.useState({rollNo:!0,regNo:!0,name:!0,gender:!0,dob:!0,fatherName:!0,motherName:!1,className:!0,status:!0}),[L,A]=n.useState(!1);n.useEffect(()=>{g()},[]);const g=async()=>{d(!0);const s=await i.getClasses();f(s),await p("ALL"),d(!1)},p=async s=>{let t=[];if(s==="ALL"){const a=await i.getClasses();for(const l of a){const r=await i.getStudentsByClass(l.id);t=[...t,...r.map(o=>({...o,className:l.name}))]}}else t=(await i.getStudentsByClass(s)).map(l=>{var r;return{...l,className:((r=m.find(o=>o.id===s))==null?void 0:r.name)||""}});t.sort((a,l)=>(a.rollNo||0)-(l.rollNo||0)),N(t)},j=async()=>{var o;const s=(o=window.jspdf)==null?void 0:o.jsPDF;if(!s)return alert("PDF Library not ready.");const t=new s,a=await i.getSchoolConfig();t.setFontSize(18),t.text((a==null?void 0:a.schoolName)||"Campus",105,15,{align:"center"}),t.setFontSize(8),t.setTextColor(200,0,0),t.text("INTERNAL AUDIT REPORT - PLEASE VERIFY DATA BEFORE PUBLISHING TO SAVE CREDITS",105,22,{align:"center"});const l=[["Roll","Reg No","Student Name","Date of Birth","Class"]],r=x.map(c=>[c.rollNo||"-",c.regNo,c.name,u(c.dob),c.className]);t.autoTable({head:l,body:r,startY:30,styles:{fontSize:8},headStyles:{fillColor:[44,62,80]}}),t.save(`Verification_Check_${h}.pdf`)};return e.jsxs("div",{className:"space-y-6 animate-fade-in-up",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 justify-between items-center bg-white dark:bg-slate-800 p-4 rounded-xl border border-slate-200 dark:border-slate-700 shadow-sm print:hidden",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("h2",{className:"font-bold text-lg text-slate-800 dark:text-white",children:"Master Register"}),e.jsxs(w,{value:h,onChange:s=>{b(s.target.value),p(s.target.value)},className:"w-40 py-1.5 text-sm",children:[e.jsx("option",{value:"ALL",children:"All Classes"}),m.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:j,className:"flex items-center gap-2 px-3 py-2 bg-amber-50 text-amber-700 border border-amber-200 rounded-lg text-xs font-black hover:bg-amber-100 transition-colors uppercase tracking-widest",children:[e.jsx(S,{className:"w-4 h-4"})," Audit PDF"]}),e.jsxs("button",{onClick:()=>window.print(),className:"flex items-center gap-2 px-3 py-2 bg-slate-900 text-white rounded-lg text-xs font-black hover:bg-black transition-colors uppercase tracking-widest",children:[e.jsx(k,{className:"w-4 h-4"})," Print"]})]})]}),e.jsx(C,{className:"p-0 overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left text-sm whitespace-nowrap",children:[e.jsx("thead",{className:"bg-slate-50 dark:bg-slate-900/50 text-slate-400 font-black uppercase text-[10px] tracking-widest border-b",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-4",children:"Roll"}),e.jsx("th",{className:"p-4",children:"Reg No"}),e.jsx("th",{className:"p-4",children:"Student Name"}),e.jsx("th",{className:"p-4",children:"DOB"}),e.jsx("th",{className:"p-4",children:"Class"}),e.jsx("th",{className:"p-4 text-center",children:"Status"})]})}),e.jsx("tbody",{className:"divide-y",children:x.map(s=>e.jsxs("tr",{className:"hover:bg-slate-50 transition-colors",children:[e.jsx("td",{className:"p-4 font-mono text-slate-400",children:s.rollNo||"-"}),e.jsx("td",{className:"p-4 font-mono font-bold",children:s.regNo}),e.jsx("td",{className:"p-4 font-black uppercase text-slate-800",children:s.name}),e.jsx("td",{className:"p-4 font-mono",children:u(s.dob)}),e.jsx("td",{className:"p-4",children:e.jsx("span",{className:"bg-blue-50 text-blue-700 px-2 py-0.5 rounded font-black text-[10px] uppercase",children:s.className})}),e.jsx("td",{className:"p-4 text-center",children:s.isVerified?e.jsx("span",{className:"text-[10px] text-green-600 font-black",children:"ACTIVE"}):e.jsx("span",{className:"text-[10px] text-orange-500 font-black",children:"PENDING"})})]},s.id))})]})})})]})};export{P as default};
